clc; clear all; close all;
M=35;tau=(M-1)/2;
n=0:M-1;
wc1=pi/4; wc2=pi/2;
hd=((sin(wc2*(n-tau)))./(pi*(n-tau)))-((sin(wc1*(n-tau)))./(pi*(n-tau)));
hd(tau+1)=0.25;
wblack=blackman(M);
h=hd.*wblack;
w=0:0.01:pi;
Hw=freqz(h,1,w);
MagHw=abs(Hw);
HwdB=20*log10(MagHw/max(MagHw));
subplot(2,2,1); stem(n,hd,'filled');
axis([-1 M -0.4 0.5]);
xlabel('n'); ylabel('hd(n)');
title('Ideal Impulse Response');
subplot(2,2,2); stem(n,wblack,'filled');
axis([-1 M -0.1 1.2]);
xlabel('n'); ylabel('w(n)');
title('Blackman Window');
subplot(2,2,3); stem(n,h,'filled');
axis([-1 M -0.4 0.5]);
xlabel('n'); ylabel('h(n)');
title('Actual Impulse Response');
subplot(2,2,4); plot(w/pi,HwdB);
axis([0 1 -150 10]);
xlabel('frequency in pi units'); ylabel('dB');
title('Magnitude Response');
